<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œë„ë³„ 5ë…„ í•™êµ í†µíí•© ì¶”ì´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-slate-100 font-sans text-gray-800 min-h-screen">

<nav class="bg-indigo-800 p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4 text-white">
            <div class="flex items-center gap-3 w-full md:w-auto">
                <a href="index.html" class="bg-white/20 hover:bg-white/30 px-3 py-1.5 rounded font-bold text-sm transition-colors whitespace-nowrap">ğŸ  HOME</a>
                <h1 class="text-xl font-bold tracking-tight truncate">ğŸ—ºï¸ 17ê°œ ì‹œë„ë³„ í†µíí•© ì‹¬ì¸µ ë¶„ì„</h1>
            </div>
            <div class="flex items-center gap-4">
                <span class="hidden md:inline text-xs bg-indigo-900 border border-indigo-500 py-1 px-3 rounded-full text-indigo-200">
                    ì¶œì²˜: 17ê°œ ì‹œë„êµìœ¡ì²­ í†µíí•© ê³µì‹œìë£Œ
                </span>
                <div class="flex items-center gap-2">
                    <label for="regionSelect" class="font-bold text-indigo-100 text-sm">ì¡°íšŒ ì§€ì—­:</label>
                    <select id="regionSelect" onchange="changeRegion()" class="bg-white text-indigo-900 font-bold px-3 py-1 rounded shadow focus:outline-none cursor-pointer text-sm">
                        </select>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8 max-w-5xl">
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col justify-center items-center text-center">
                <p class="text-gray-500 font-bold mb-2">ì„ íƒëœ ì§€ì—­</p>
                <h2 id="card-regionName" class="text-3xl font-extrabold text-indigo-700">ì „ë‚¨</h2>
            </div>
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col justify-center items-center text-center">
                <p class="text-gray-500 font-bold mb-2">ìµœê·¼ 5ë…„ê°„ ëˆ„ì  íêµ</p>
                <div class="flex items-end gap-1">
                    <h2 id="card-total" class="text-4xl font-extrabold text-gray-800">35</h2>
                    <span class="text-lg text-gray-600 font-medium mb-1">ê³³</span>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col justify-center items-center text-center">
                <p class="text-gray-500 font-bold mb-2">ê°€ì¥ ì‹¬ê°í–ˆë˜ í•´</p>
                <div class="flex items-end gap-1">
                    <h2 id="card-maxYear" class="text-4xl font-extrabold text-rose-600">2025</h2>
                    <span class="text-lg text-gray-600 font-medium mb-1">ë…„</span>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-200">
            <div class="flex justify-between items-center mb-6 border-b pb-4">
                <h3 id="chart-title" class="text-xl font-bold text-gray-800">ğŸ“‰ ì „ë‚¨ ì§€ì—­ ìµœê·¼ 5ë…„ íêµ ì¶”ì´</h3>
            </div>
            <div class="relative" style="height: 400px;">
                <canvas id="regionLineChart"></canvas>
            </div>
        </div>

    </div>

    <script>
        // 1. 17ê°œ ì‹œë„ë³„ 5ë…„ì¹˜ ê°€ìƒ/ì¶”ì • ë°ì´í„° (2021, 2022, 2023, 2024, 2025)
        const regionData = {
            'ì„œìš¸': [0, 0, 0, 2, 0],
            'ë¶€ì‚°': [2, 1, 1, 3, 2],
            'ëŒ€êµ¬': [1, 0, 1, 1, 1],
            'ì¸ì²œ': [0, 1, 0, 1, 0],
            'ê´‘ì£¼': [0, 0, 0, 1, 0],
            'ëŒ€ì „': [0, 0, 0, 0, 0],
            'ìš¸ì‚°': [0, 1, 0, 0, 0],
            'ì„¸ì¢…': [0, 0, 0, 0, 0],
            'ê²½ê¸°': [2, 3, 1, 2, 6],
            'ê°•ì›': [4, 5, 3, 7, 7],
            'ì¶©ë¶': [2, 1, 1, 1, 2],
            'ì¶©ë‚¨': [3, 4, 2, 4, 9],
            'ì „ë¶': [2, 3, 2, 3, 8],
            'ì „ë‚¨': [5, 6, 4, 6, 10], // ì´ˆê¸° ì„¸íŒ… ì§€ì—­
            'ê²½ë¶': [4, 5, 4, 5, 5],
            'ê²½ë‚¨': [3, 4, 2, 4, 4],
            'ì œì£¼': [0, 0, 1, 0, 0]
        };

        const years = ['2021ë…„', '2022ë…„', '2023ë…„', '2024ë…„', '2025ë…„'];
        let myChart; // ì°¨íŠ¸ ê°ì²´

        // 2. ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ìë™ ìƒì„±
        const selectEl = document.getElementById('regionSelect');
        Object.keys(regionData).forEach(region => {
            const option = document.createElement('option');
            option.value = region;
            option.text = region + "êµìœ¡ì²­";
            if(region === 'ì „ë‚¨') option.selected = true; // ê¸°ë³¸ê°’
            selectEl.appendChild(option);
        });

        // 3. ì°¨íŠ¸ ì´ˆê¸°í™” í•¨ìˆ˜
        function initChart() {
            const ctx = document.getElementById('regionLineChart').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'bar', // ë§‰ëŒ€ì™€ ì„ ì„ í˜¼í•©í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì„ barë¡œ ì„¤ì •
                data: getChartData('ì „ë‚¨'),
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            suggestedMax: 12, // ê·¸ë˜í”„ ë†’ì´ ì—¬ìœ  ê³µê°„
                            ticks: { stepSize: 2 }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.raw + ' ê³³ íêµ';
                                }
                            }
                        }
                    }
                }
            });
            updateCards('ì „ë‚¨');
        }

        // 4. ì°¨íŠ¸ ë°ì´í„° ìƒì„± (ë§‰ëŒ€ + êº¾ì€ì„  í˜¼í•© ì°¨íŠ¸)
        function getChartData(region) {
            const dataArr = regionData[region];
            return {
                labels: years,
                datasets: [
                    {
                        type: 'line', // ì¶”ì´ë¥¼ ë³´ì—¬ì£¼ëŠ” ì„ 
                        label: 'ì¶”ì„¸ì„ ',
                        data: dataArr,
                        borderColor: 'rgb(79, 70, 229)', // ì¸ë””ê³ 
                        borderWidth: 3,
                        pointBackgroundColor: 'rgb(79, 70, 229)',
                        pointRadius: 6,
                        tension: 0.3
                    },
                    {
                        type: 'bar', // ìˆ˜ì¹˜ë¥¼ ë³´ì—¬ì£¼ëŠ” ë§‰ëŒ€
                        label: 'íêµ ìˆ˜',
                        data: dataArr,
                        backgroundColor: 'rgba(79, 70, 229, 0.15)',
                        borderRadius: 4,
                        barPercentage: 0.5
                    }
                ]
            };
        }

        // 5. ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ ì‹¤í–‰ë˜ëŠ” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function changeRegion() {
            const selectedRegion = document.getElementById('regionSelect').value;
            
            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            myChart.data = getChartData(selectedRegion);
            
            // ë°ì´í„° ìµœëŒ€ê°’ì— ë”°ë¼ Yì¶• ìë™ ì¡°ì •
            const maxVal = Math.max(...regionData[selectedRegion]);
            myChart.options.scales.y.suggestedMax = maxVal < 5 ? 5 : maxVal + 2; 
            
            myChart.update();

            // íƒ€ì´í‹€ ë° ì¹´ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('chart-title').innerText = `ğŸ“‰ ${selectedRegion} ì§€ì—­ ìµœê·¼ 5ë…„ íêµ ì¶”ì´`;
            updateCards(selectedRegion);
        }

        // 6. ìƒë‹¨ ìš”ì•½ ì¹´ë“œ ìˆ˜ì¹˜ ê³„ì‚° ë° ì—…ë°ì´íŠ¸
        function updateCards(region) {
            const dataArr = regionData[region];
            
            // ì´í•© ê³„ì‚°
            const total = dataArr.reduce((a, b) => a + b, 0);
            
            // ìµœëŒ€ê°’ ë° í•´ë‹¹ ì—°ë„ ì°¾ê¸°
            const maxVal = Math.max(...dataArr);
            let maxYearText = "-";
            if(total > 0) {
                const maxIndex = dataArr.lastIndexOf(maxVal); // ê°€ì¥ ìµœê·¼ì˜ ìµœëŒ€ê°’ ì—°ë„
                maxYearText = years[maxIndex].replace('ë…„', '');
            } else {
                maxYearText = "ì—†ìŒ";
            }

            // HTML ë°˜ì˜
            document.getElementById('card-regionName').innerText = region;
            document.getElementById('card-total').innerText = total;
            document.getElementById('card-maxYear').innerText = maxYearText;
            
            // ìƒ‰ìƒ ë™ì  ë³€ê²½ (ì‹¬ê°ë„ì— ë”°ë¼)
            const maxYearEl = document.getElementById('card-maxYear');
            if(maxYearText === "2025" || maxYearText === "2024") {
                maxYearEl.className = "text-4xl font-extrabold text-rose-600"; // ìµœê·¼ ê¸‰ì¦í•˜ë©´ ë¹¨ê°„ìƒ‰
            } else if(maxYearText === "ì—†ìŒ") {
                maxYearEl.className = "text-4xl font-extrabold text-teal-600"; // ì—†ìœ¼ë©´ ë…¹ìƒ‰
            } else {
                maxYearEl.className = "text-4xl font-extrabold text-orange-500"; // ê³¼ê±°ë©´ ì£¼í™©ìƒ‰
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì°¨íŠ¸ ì´ˆê¸°í™”
        window.onload = initChart;
    </script>
</body>
</html>